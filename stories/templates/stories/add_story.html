{% extends "base.html" %}

{% load static %}

{% block title %}Add Story{% endblock %}

{% block content %}
    <div class="form-container">
        <h2 class="title">Add Story</h2>
        <form method="post">
            {% csrf_token %}

            <div class="form-group">
                <label for="id_title">Title:</label>
                {{ form.title }}
            </div>

            <div class="form-group">
                <label for="id_content">Story:</label>
                <textarea id="story_content" name="content" rows="10" cols="50" oninput="limitWords()"></textarea>
                <p id="word-count">0 / 500 words</p>
            </div>

            <button type="submit" class="btn btn-custom w-100">Add Story</button>
        </form>

        <a href="{% url 'story_list' %}" class="link">Back to story list</a>
    </div>

    <script>
        function limitWords() {
            let textArea = document.getElementById("story_content");
            let wordCountDisplay = document.getElementById("word-count");
            let maxWords = 500;
    
            // Split the input text by spaces, filtering out any empty words
            let words = textArea.value.trim().split(/\s+/);
    
            if (words.length > maxWords) {
                // If the word count exceeds the limit, truncate the text
                textArea.value = words.slice(0, maxWords).join(" ");
            }
    
            // Update the word count display
            wordCountDisplay.innerText = words.length + " / " + maxWords + " words";
        }
    </script>
    
{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
{% endblock %}
